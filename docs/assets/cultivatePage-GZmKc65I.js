/* empty css                  *//* empty css                     */import{e as t}from"./equip-eJVsYbcZ.js";import{_ as s,c as e,a as i,b as a,w as l,C as r,E as o,o as h,F as n,m as p,e as c}from"./index-C3HF_ROH.js";const y={class:"cultivate"},v={class:"storyText"},u={class:"storyText-box"},m=["innerHTML"],d={class:"actions"},f={class:"action"},b={class:"action"},x={class:"action"},$={class:"action"};const C=s({data:()=>({texts:[],player:{},isStop:!1,isStart:!1,timerIds:[],observer:null}),beforeDestroy(){this.stopCultivate(),this.stopObserving()},mounted(){this.player=this.$store.state.player,this.startCultivate(),this.setupObserver()},methods:{startCultivate(){this.isStart=!1;const s=10*player.reincarnation,e=setInterval((()=>{if(this.player.cultivation<=this.player.maxCultivation){this.isStop=!0,this.isStart=!1;const s=this.player.level<=10?Math.floor(this.player.maxCultivation/t.getRandomInt(10,30)):Math.floor(this.player.maxCultivation/100);this.texts=[...this.texts,this.player.level<this.$maxLv?"你开始冥想，吸收周围的灵气。修为提升了！":"你当前的境界已修炼圆满, 需要转生后才能继续修炼"],this.breakThrough(s)}else this.breakThrough(100)}),s>=200?100:300-s);this.timerIds.push(e)},stopCultivate(){this.timerIds.forEach((t=>{clearInterval(t)})),this.timerIds=[],this.isStart=!0,this.isStop=!1},breakThrough(t){const s=this.player.reincarnation?this.player.reincarnation+1:1;if(this.player.level<this.$maxLv)if(this.player.cultivation>=this.player.maxCultivation){if(this.player.level>10&&this.player.level>this.player.taskNum)return this.stopCultivate(),this.isStop=!1,this.isStart=!1,void(this.texts=[...this.texts,`当前境界修为已满, 你需要通过击败<span style="color: #f56c6c;">(${this.player.taskNum} / ${this.player.level})</span>个敌人证道突破`]);this.player.taskNum=0,this.player.level++,this.player.points+=3,this.player.health=this.player.maxHealth,this.player.maxCultivation=Math.floor(100*Math.pow(2,this.player.level*s)),this.texts=[...this.texts,`恭喜你突破了！当前境界：${this.$levelNames(this.player.level)}`]}else this.player.cultivation+=t;else this.isStop=!1,this.isStart=!1,this.player.level=this.$maxLv,this.player.maxCultivation=Math.floor(100*Math.pow(2,this.$maxLv*s)),this.stopCultivate();this.$store.commit("setPlayer",this.player)},reincarnationBreakthrough(){let t=this.player.reincarnation;if(t=0==t?100:100*t,this.player.level==this.$maxLv){if(this.player.points)return void this.$notifys({title:"未满足转生条件",message:`当前还有${this.player.points}境界点未使用, 无法转生`});if(this.player.taskNum>=t){const t=0==this.player.reincarnation?"转生之后的敌人属性是转生前的百倍<br>转生前请务必确认自己的实力是否足够战胜转生后的对手, 避免卡档后删档重练":"转生操作不可逆, 是否确定要转生?";this.$confirm(t,"转生提醒",{center:!0,cancelButtonText:"取消转生",confirmButtonText:"立即转生",dangerouslyUseHTMLString:!0}).then((()=>{this.player.level=0,this.player.cultivation=0,this.player.maxCultivation=100,this.player.taskNum=0,this.player.reincarnation++,this.player.backpackCapacity+=50,this.$notifys({title:"转生提示",message:`转生成功, 当前为${this.player.reincarnation}转, 背包总容量增加50`,dangerouslyUseHTMLString:!0}),this.$store.commit("setPlayer",this.player)})).catch((()=>{}))}else this.$notifys({title:"未满足转生条件",message:`需要通过击败<span style="color: #f56c6c;">(${this.player.taskNum} / ${t})</span>个敌人证道转生`,dangerouslyUseHTMLString:!0})}else this.$notifys({title:"未满足转生条件",message:`境界需要达到<span style="color: #f56c6c;">${this.$levelNames(this.$maxLv)}</span>才能满足转生条件`,dangerouslyUseHTMLString:!0})},setupObserver(){const t=this.$refs.scrollbar.wrapRef;t&&(this.observer=new MutationObserver((()=>{this.$smoothScrollToBottom(t)})),this.observer.observe(t,{childList:!0,subtree:!0}))},stopObserving(){this.observer&&(this.observer.disconnect(),this.observer=null)}}},[["render",function(t,s,C,g,k,S){const T=r,L=o;return h(),e("div",y,[i("div",v,[i("div",u,[a(T,{ref:"scrollbar",always:""},{default:l((()=>[(h(!0),e(n,null,p(k.texts,((t,s)=>(h(),e("p",{key:s,innerHTML:t},null,8,m)))),128))])),_:1},512)])]),i("div",d,[i("div",f,[a(L,{class:"item",onClick:S.startCultivate,disabled:!k.isStart},{default:l((()=>s[1]||(s[1]=[c(" 开始修炼 ")]))),_:1},8,["onClick","disabled"])]),i("div",b,[a(L,{class:"item",onClick:S.stopCultivate,disabled:!k.isStop},{default:l((()=>s[2]||(s[2]=[c(" 停止修炼 ")]))),_:1},8,["onClick","disabled"])]),i("div",x,[a(L,{class:"item",onClick:S.reincarnationBreakthrough},{default:l((()=>s[3]||(s[3]=[c(" 转生突破 ")]))),_:1},8,["onClick"])]),i("div",$,[a(L,{class:"item",onClick:s[0]||(s[0]=s=>t.$router.push("/home"))},{default:l((()=>s[4]||(s[4]=[c(" 返回家里 ")]))),_:1})])])])}],["__scopeId","data-v-3455611b"]]);export{C as default};
